<% include head.ejs %>
<script src="/js/cytoscape.js"></script>

<div id="cy"></div>

<script>

// the network id passed from the ejs template
var networkRID = '<%= networkId %>';

function formatError(error){

}

var cyNetworkParams = {

		  layout: {
			name: 'circle'
		  },
		  style: cytoscape.stylesheet()
			.selector('node')
			  .css({
				'content': 'data(name)',
				'text-valign': 'center',
				'color': 'white',
//				'text-outline-width': 2,
//				'text-outline-color': '#888'
			  })
			.selector('edge')
			  .css({
				'target-arrow-shape': 'triangle'
			  })
			.selector(':selected')
			  .css({
				'background-color': 'black',
				'line-color': 'black',
				'target-arrow-color': 'black',
				'source-arrow-color': 'black'
			  })
			.selector('.faded')
			  .css({
				'opacity': 0.25,
				'text-opacity': 0
			  }), 
		  

		};

// On load, we get the network, then push it to cytoscape.js on the callback
$(ndexClient.getNetwork(networkRID, function(data){
		console.log("Got results from getNetwork");
		console.log(data);
	
  		var elements = {nodes: [], edges: []};
  		
  		$.each(data.network.nodes, function(index, node){
  			var cyNode = {data:{id: "n" + index, name: node.name}};
  			elements.nodes.push(cyNode);
  		
  		});
  		
  		$.each(data.network.edges, function(index, edge){
  			var cyEdge = {data: {source: "n" + edge.s, target: "n" + edge.o}};
  			elements.edges.push(cyEdge);
  		});
  		
  		cyNetworkParams.elements = elements;
  		
  		$('#cy').cytoscape(cyNetworkParams);

    },
    // error handler
    function(error){
    	$('#results').append(formatError(error));
    })
);
</script>

<% include foot.ejs %>